---
phase: 01-foundation-authentication
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - frontend/package.json
  - frontend/app/lib/dal.ts
  - frontend/app/lib/api.ts
  - frontend/app/lib/session.ts
  - frontend/app/actions/auth.ts
  - frontend/middleware.ts
  - frontend/app/(auth)/login/page.tsx
  - frontend/app/(auth)/signup/page.tsx
  - frontend/app/(auth)/reset-password/page.tsx
  - frontend/app/(auth)/forgot-password/page.tsx
  - frontend/app/page.tsx
  - frontend/app/layout.tsx
  - frontend/.env.local
autonomous: true

must_haves:
  truths:
    - "User can visit /login and see login form"
    - "User can submit login form and be redirected to dashboard"
    - "User can visit /signup with invite token and see signup form"
    - "User can submit signup form and be logged in automatically"
    - "User can visit /forgot-password and request reset email"
    - "User can visit /reset-password with token and set new password"
    - "Logged in user visiting /login is redirected to dashboard"
    - "Logged out user visiting / is redirected to /login"
    - "Session persists across browser refresh"
  artifacts:
    - path: "frontend/app/lib/dal.ts"
      provides: "Data Access Layer with verifySession"
      contains: "verifySession"
      exports: ["verifySession", "getUser"]
    - path: "frontend/app/actions/auth.ts"
      provides: "Server Actions for auth"
      contains: "'use server'"
    - path: "frontend/middleware.ts"
      provides: "Route protection middleware"
      contains: "matcher"
    - path: "frontend/app/(auth)/login/page.tsx"
      provides: "Login page with form"
      min_lines: 30
  key_links:
    - from: "frontend/app/actions/auth.ts"
      to: "Rails API /api/v1/session"
      via: "fetch in login action"
      pattern: "fetch.*api/v1/session"
    - from: "frontend/app/lib/dal.ts"
      to: "httpOnly cookie"
      via: "cookies().get"
      pattern: "cookies.*get.*session"
    - from: "frontend/middleware.ts"
      to: "frontend/app/lib/dal.ts"
      via: "redirect logic based on session"
      pattern: "redirect.*login"
---

<objective>
Create Next.js 16 frontend with complete authentication flows

Purpose: Build the user-facing authentication experience with login, invite-based signup, password reset, and session persistence. Uses Server Actions and DAL pattern for secure auth handling.

Output:
- Working Next.js 16 application with TypeScript
- Login page with form and validation
- Signup page (requires invite token in URL)
- Password reset flow (request + reset with token)
- Middleware for route protection
- Session stored in httpOnly cookie, persists across refresh
</objective>

<execution_context>
@/Users/superuser/.claude/get-shit-done/workflows/execute-plan.md
@/Users/superuser/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-authentication/01-RESEARCH.md
@.planning/phases/01-foundation-authentication/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project with auth library layer</name>
  <files>
    frontend/package.json
    frontend/app/lib/api.ts
    frontend/app/lib/session.ts
    frontend/app/lib/dal.ts
    frontend/.env.local
    frontend/app/lib/definitions.ts
  </files>
  <action>
    1. Create Next.js 16 project:
       ```bash
       npx create-next-app@latest frontend --typescript --tailwind --app --no-src-dir --eslint
       cd frontend
       npm install jose zod
       ```

    2. Create environment file (frontend/.env.local):
       ```
       API_URL=http://localhost:3000
       SESSION_SECRET=your-session-secret-at-least-32-chars-long
       NEXT_PUBLIC_APP_NAME=Influenza
       ```

    3. Create type definitions (frontend/app/lib/definitions.ts):
       ```typescript
       export interface User {
         id: number
         email_address: string
         admin: boolean
       }

       export interface SessionPayload {
         token: string
         userId: number
         expiresAt: Date
       }

       export interface ActionState {
         errors?: {
           email?: string[]
           password?: string[]
           general?: string[]
         }
         success?: boolean
       }
       ```

    4. Create API client (frontend/app/lib/api.ts):
       ```typescript
       import { cookies } from 'next/headers'

       const API_URL = process.env.API_URL || 'http://localhost:3000'

       export async function apiRequest<T>(
         endpoint: string,
         options: RequestInit = {}
       ): Promise<{ data?: T; error?: string; status: number }> {
         const cookieStore = await cookies()
         const token = cookieStore.get('session')?.value

         const headers: HeadersInit = {
           'Content-Type': 'application/json',
           ...(token && { Authorization: `Bearer ${token}` }),
           ...options.headers,
         }

         try {
           const response = await fetch(`${API_URL}${endpoint}`, {
             ...options,
             headers,
           })

           const data = response.ok ? await response.json() : null
           const error = !response.ok
             ? (await response.json().catch(() => ({ error: 'Request failed' }))).error
             : undefined

           return { data, error, status: response.status }
         } catch (error) {
           return { error: 'Network error', status: 0 }
         }
       }
       ```

    5. Create session management (frontend/app/lib/session.ts):
       ```typescript
       import 'server-only'
       import { SignJWT, jwtVerify } from 'jose'
       import { cookies } from 'next/headers'
       import { SessionPayload } from './definitions'

       const secretKey = process.env.SESSION_SECRET
       const encodedKey = new TextEncoder().encode(secretKey)

       export async function encrypt(payload: SessionPayload): Promise<string> {
         return new SignJWT({ ...payload })
           .setProtectedHeader({ alg: 'HS256' })
           .setIssuedAt()
           .setExpirationTime('7d')
           .sign(encodedKey)
       }

       export async function decrypt(session: string): Promise<SessionPayload | null> {
         try {
           const { payload } = await jwtVerify(session, encodedKey, {
             algorithms: ['HS256'],
           })
           return payload as unknown as SessionPayload
         } catch {
           return null
         }
       }

       export async function createSession(token: string, userId: number): Promise<void> {
         const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
         const session = await encrypt({ token, userId, expiresAt })

         const cookieStore = await cookies()
         cookieStore.set('session', session, {
           httpOnly: true,
           secure: process.env.NODE_ENV === 'production',
           sameSite: 'lax',
           expires: expiresAt,
           path: '/',
         })
       }

       export async function deleteSession(): Promise<void> {
         const cookieStore = await cookies()
         cookieStore.delete('session')
       }

       export async function getSession(): Promise<SessionPayload | null> {
         const cookieStore = await cookies()
         const sessionCookie = cookieStore.get('session')?.value
         if (!sessionCookie) return null
         return decrypt(sessionCookie)
       }
       ```

    6. Create Data Access Layer (frontend/app/lib/dal.ts):
       ```typescript
       import 'server-only'
       import { cache } from 'react'
       import { getSession } from './session'
       import { apiRequest } from './api'
       import { User } from './definitions'

       export const verifySession = cache(async () => {
         const session = await getSession()

         if (!session) {
           return { isAuth: false as const }
         }

         return {
           isAuth: true as const,
           userId: session.userId,
           token: session.token,
         }
       })

       export const getUser = cache(async (): Promise<User | null> => {
         const session = await verifySession()

         if (!session.isAuth) {
           return null
         }

         const { data, error } = await apiRequest<User>(`/api/v1/users/${session.userId}`)

         if (error || !data) {
           return null
         }

         return data
       })
       ```
  </action>
  <verify>
    ```bash
    cd frontend
    npm run build 2>&1 | head -20
    ls -la app/lib/
    ```
    Build starts successfully. All lib files exist (api.ts, session.ts, dal.ts, definitions.ts).
  </verify>
  <done>
    - Next.js 16 project exists in /frontend directory
    - jose and zod installed
    - Type definitions for User, SessionPayload, ActionState
    - API client with automatic token injection
    - Session management with JWT encryption in httpOnly cookie
    - DAL with verifySession and getUser functions (cached)
    - Environment variables configured
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement auth Server Actions and middleware</name>
  <files>
    frontend/app/actions/auth.ts
    frontend/middleware.ts
  </files>
  <action>
    1. Create auth Server Actions (frontend/app/actions/auth.ts):
       ```typescript
       'use server'

       import { z } from 'zod'
       import { redirect } from 'next/navigation'
       import { createSession, deleteSession } from '@/app/lib/session'
       import { ActionState } from '@/app/lib/definitions'

       const API_URL = process.env.API_URL || 'http://localhost:3000'

       const loginSchema = z.object({
         email: z.string().email('Invalid email address'),
         password: z.string().min(1, 'Password is required'),
       })

       const signupSchema = z.object({
         password: z.string().min(8, 'Password must be at least 8 characters'),
         invite_token: z.string().min(1, 'Invitation token is required'),
       })

       const forgotPasswordSchema = z.object({
         email: z.string().email('Invalid email address'),
       })

       const resetPasswordSchema = z.object({
         password: z.string().min(8, 'Password must be at least 8 characters'),
         token: z.string().min(1, 'Reset token is required'),
       })

       export async function login(
         prevState: ActionState | undefined,
         formData: FormData
       ): Promise<ActionState> {
         const validatedFields = loginSchema.safeParse({
           email: formData.get('email'),
           password: formData.get('password'),
         })

         if (!validatedFields.success) {
           return { errors: validatedFields.error.flatten().fieldErrors }
         }

         const { email, password } = validatedFields.data

         const response = await fetch(`${API_URL}/api/v1/session`, {
           method: 'POST',
           headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ email, password }),
         })

         if (!response.ok) {
           return { errors: { general: ['Invalid email or password'] } }
         }

         const { token, user } = await response.json()
         await createSession(token, user.id)

         redirect('/')
       }

       export async function signup(
         prevState: ActionState | undefined,
         formData: FormData
       ): Promise<ActionState> {
         const validatedFields = signupSchema.safeParse({
           password: formData.get('password'),
           invite_token: formData.get('invite_token'),
         })

         if (!validatedFields.success) {
           return { errors: validatedFields.error.flatten().fieldErrors }
         }

         const { password, invite_token } = validatedFields.data

         const response = await fetch(`${API_URL}/api/v1/users`, {
           method: 'POST',
           headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ password, invite_token }),
         })

         if (!response.ok) {
           const error = await response.json().catch(() => ({}))
           return { errors: { general: [error.error || 'Invalid or expired invitation'] } }
         }

         const { token, user } = await response.json()
         await createSession(token, user.id)

         redirect('/')
       }

       export async function logout(): Promise<void> {
         await deleteSession()
         redirect('/login')
       }

       export async function forgotPassword(
         prevState: ActionState | undefined,
         formData: FormData
       ): Promise<ActionState> {
         const validatedFields = forgotPasswordSchema.safeParse({
           email: formData.get('email'),
         })

         if (!validatedFields.success) {
           return { errors: validatedFields.error.flatten().fieldErrors }
         }

         const { email } = validatedFields.data

         await fetch(`${API_URL}/api/v1/password`, {
           method: 'POST',
           headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ email }),
         })

         // Always show success (don't reveal if email exists)
         return { success: true }
       }

       export async function resetPassword(
         prevState: ActionState | undefined,
         formData: FormData
       ): Promise<ActionState> {
         const validatedFields = resetPasswordSchema.safeParse({
           password: formData.get('password'),
           token: formData.get('token'),
         })

         if (!validatedFields.success) {
           return { errors: validatedFields.error.flatten().fieldErrors }
         }

         const { password, token } = validatedFields.data

         const response = await fetch(`${API_URL}/api/v1/password`, {
           method: 'PUT',
           headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ password, token }),
         })

         if (!response.ok) {
           return { errors: { general: ['Invalid or expired reset link'] } }
         }

         return { success: true }
       }

       export async function verifyInvitation(token: string): Promise<{ email?: string; error?: string }> {
         const response = await fetch(`${API_URL}/api/v1/invitations/verify?token=${token}`)

         if (!response.ok) {
           return { error: 'Invalid or expired invitation' }
         }

         const data = await response.json()
         return { email: data.email }
       }
       ```

    2. Create middleware for route protection (frontend/middleware.ts):
       ```typescript
       import { NextResponse } from 'next/server'
       import type { NextRequest } from 'next/server'

       const publicPaths = ['/login', '/signup', '/forgot-password', '/reset-password']

       export function middleware(request: NextRequest) {
         const sessionCookie = request.cookies.get('session')
         const { pathname } = request.nextUrl

         const isPublicPath = publicPaths.some(
           (path) => pathname === path || pathname.startsWith(path + '/')
         )

         // If no session and trying to access protected route
         if (!sessionCookie && !isPublicPath) {
           const loginUrl = new URL('/login', request.url)
           loginUrl.searchParams.set('redirect', pathname)
           return NextResponse.redirect(loginUrl)
         }

         // If has session and trying to access auth pages (except logout)
         if (sessionCookie && isPublicPath && pathname !== '/logout') {
           return NextResponse.redirect(new URL('/', request.url))
         }

         return NextResponse.next()
       }

       export const config = {
         matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],
       }
       ```
  </action>
  <verify>
    ```bash
    cd frontend
    grep -l "use server" app/actions/*.ts
    cat middleware.ts | head -20
    npm run build 2>&1 | tail -5
    ```
    Server Actions file exists with 'use server' directive. Middleware exists. Build completes.
  </verify>
  <done>
    - Auth Server Actions: login, signup, logout, forgotPassword, resetPassword, verifyInvitation
    - Middleware redirects unauthenticated users to /login
    - Middleware redirects authenticated users away from auth pages
    - All actions use Zod for validation
    - Session created on successful login/signup
    - Session deleted on logout
  </done>
</task>

<task type="auto">
  <name>Task 3: Create auth pages and dashboard</name>
  <files>
    frontend/app/(auth)/login/page.tsx
    frontend/app/(auth)/signup/page.tsx
    frontend/app/(auth)/forgot-password/page.tsx
    frontend/app/(auth)/reset-password/page.tsx
    frontend/app/(auth)/layout.tsx
    frontend/app/page.tsx
    frontend/app/layout.tsx
    frontend/app/components/LogoutButton.tsx
  </files>
  <action>
    1. Create auth layout (frontend/app/(auth)/layout.tsx):
       ```tsx
       export default function AuthLayout({
         children,
       }: {
         children: React.ReactNode
       }) {
         return (
           <div className="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
             <div className="max-w-md w-full space-y-8">
               <div className="text-center">
                 <h1 className="text-3xl font-bold text-gray-900">Influenza</h1>
                 <p className="mt-2 text-sm text-gray-600">Influencer Call Tracker</p>
               </div>
               {children}
             </div>
           </div>
         )
       }
       ```

    2. Create login page (frontend/app/(auth)/login/page.tsx):
       ```tsx
       'use client'

       import { useActionState } from 'react'
       import { login } from '@/app/actions/auth'
       import Link from 'next/link'

       export default function LoginPage() {
         const [state, action, pending] = useActionState(login, undefined)

         return (
           <form action={action} className="mt-8 space-y-6">
             {state?.errors?.general && (
               <div className="bg-red-50 text-red-600 p-3 rounded-md text-sm">
                 {state.errors.general.join(', ')}
               </div>
             )}

             <div className="space-y-4">
               <div>
                 <label htmlFor="email" className="block text-sm font-medium text-gray-700">
                   Email address
                 </label>
                 <input
                   id="email"
                   name="email"
                   type="email"
                   autoComplete="email"
                   required
                   className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                 />
                 {state?.errors?.email && (
                   <p className="mt-1 text-sm text-red-600">{state.errors.email.join(', ')}</p>
                 )}
               </div>

               <div>
                 <label htmlFor="password" className="block text-sm font-medium text-gray-700">
                   Password
                 </label>
                 <input
                   id="password"
                   name="password"
                   type="password"
                   autoComplete="current-password"
                   required
                   className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
                 />
                 {state?.errors?.password && (
                   <p className="mt-1 text-sm text-red-600">{state.errors.password.join(', ')}</p>
                 )}
               </div>
             </div>

             <div className="flex items-center justify-between">
               <Link
                 href="/forgot-password"
                 className="text-sm text-indigo-600 hover:text-indigo-500"
               >
                 Forgot your password?
               </Link>
             </div>

             <button
               type="submit"
               disabled={pending}
               className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"
             >
               {pending ? 'Signing in...' : 'Sign in'}
             </button>
           </form>
         )
       }
       ```

    3. Create signup page (frontend/app/(auth)/signup/page.tsx):
       ```tsx
       'use client'

       import { useActionState, useEffect, useState } from 'react'
       import { useSearchParams } from 'next/navigation'
       import { signup, verifyInvitation } from '@/app/actions/auth'
       import { Suspense } from 'react'

       function SignupForm() {
         const searchParams = useSearchParams()
         const token = searchParams.get('token')

         const [state, action, pending] = useActionState(signup, undefined)
         const [invitation, setInvitation] = useState<{ email?: string; error?: string } | null>(null)
         const [loading, setLoading] = useState(true)

         useEffect(() => {
           if (token) {
             verifyInvitation(token).then((result) => {
               setInvitation(result)
               setLoading(false)
             })
           } else {
             setInvitation({ error: 'No invitation token provided' })
             setLoading(false)
           }
         }, [token])

         if (loading) {
           return <div className="text-center py-8">Verifying invitation...</div>
         }

         if (invitation?.error) {
           return (
             <div className="text-center py-8">
               <div className="bg-red-50 text-red-600 p-4 rounded-md">
                 {invitation.error}
               </div>
               <p className="mt-4 text-sm text-gray-600">
                 Please contact an administrator for a new invitation.
               </p>
             </div>
           )
         }

         return (
           <form action={action} className="mt-8 space-y-6">
             <input type="hidden" name="invite_token" value={token || ''} />

             {state?.errors?.general && (
               <div className="bg-red-50 text-red-600 p-3 rounded-md text-sm">
                 {state.errors.general.join(', ')}
               </div>
             )}

             <div className="bg-gray-50 p-4 rounded-md">
               <p className="text-sm text-gray-600">Creating account for:</p>
               <p className="font-medium text-gray-900">{invitation?.email}</p>
             </div>

             <div>
               <label htmlFor="password" className="block text-sm font-medium text-gray-700">
                 Choose a password
               </label>
               <input
                 id="password"
                 name="password"
                 type="password"
                 autoComplete="new-password"
                 required
                 minLength={8}
                 className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
               />
               {state?.errors?.password && (
                 <p className="mt-1 text-sm text-red-600">{state.errors.password.join(', ')}</p>
               )}
               <p className="mt-1 text-xs text-gray-500">Must be at least 8 characters</p>
             </div>

             <button
               type="submit"
               disabled={pending}
               className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"
             >
               {pending ? 'Creating account...' : 'Create account'}
             </button>
           </form>
         )
       }

       export default function SignupPage() {
         return (
           <Suspense fallback={<div className="text-center py-8">Loading...</div>}>
             <SignupForm />
           </Suspense>
         )
       }
       ```

    4. Create forgot password page (frontend/app/(auth)/forgot-password/page.tsx):
       ```tsx
       'use client'

       import { useActionState } from 'react'
       import { forgotPassword } from '@/app/actions/auth'
       import Link from 'next/link'

       export default function ForgotPasswordPage() {
         const [state, action, pending] = useActionState(forgotPassword, undefined)

         if (state?.success) {
           return (
             <div className="mt-8 space-y-6">
               <div className="bg-green-50 text-green-600 p-4 rounded-md text-center">
                 <p className="font-medium">Check your email</p>
                 <p className="mt-1 text-sm">
                   If an account exists with that email, we&apos;ve sent password reset instructions.
                 </p>
               </div>
               <Link
                 href="/login"
                 className="block text-center text-sm text-indigo-600 hover:text-indigo-500"
               >
                 Return to login
               </Link>
             </div>
           )
         }

         return (
           <form action={action} className="mt-8 space-y-6">
             <p className="text-sm text-gray-600">
               Enter your email address and we&apos;ll send you a link to reset your password.
             </p>

             {state?.errors?.general && (
               <div className="bg-red-50 text-red-600 p-3 rounded-md text-sm">
                 {state.errors.general.join(', ')}
               </div>
             )}

             <div>
               <label htmlFor="email" className="block text-sm font-medium text-gray-700">
                 Email address
               </label>
               <input
                 id="email"
                 name="email"
                 type="email"
                 autoComplete="email"
                 required
                 className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
               />
               {state?.errors?.email && (
                 <p className="mt-1 text-sm text-red-600">{state.errors.email.join(', ')}</p>
               )}
             </div>

             <button
               type="submit"
               disabled={pending}
               className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"
             >
               {pending ? 'Sending...' : 'Send reset link'}
             </button>

             <Link
               href="/login"
               className="block text-center text-sm text-indigo-600 hover:text-indigo-500"
             >
               Back to login
             </Link>
           </form>
         )
       }
       ```

    5. Create reset password page (frontend/app/(auth)/reset-password/page.tsx):
       ```tsx
       'use client'

       import { useActionState } from 'react'
       import { useSearchParams } from 'next/navigation'
       import { resetPassword } from '@/app/actions/auth'
       import Link from 'next/link'
       import { Suspense } from 'react'

       function ResetPasswordForm() {
         const searchParams = useSearchParams()
         const token = searchParams.get('token')

         const [state, action, pending] = useActionState(resetPassword, undefined)

         if (!token) {
           return (
             <div className="mt-8 text-center">
               <div className="bg-red-50 text-red-600 p-4 rounded-md">
                 Invalid reset link. Please request a new password reset.
               </div>
               <Link
                 href="/forgot-password"
                 className="mt-4 inline-block text-sm text-indigo-600 hover:text-indigo-500"
               >
                 Request new reset link
               </Link>
             </div>
           )
         }

         if (state?.success) {
           return (
             <div className="mt-8 space-y-6">
               <div className="bg-green-50 text-green-600 p-4 rounded-md text-center">
                 <p className="font-medium">Password updated!</p>
                 <p className="mt-1 text-sm">
                   Your password has been reset successfully.
                 </p>
               </div>
               <Link
                 href="/login"
                 className="block text-center w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700"
               >
                 Sign in with new password
               </Link>
             </div>
           )
         }

         return (
           <form action={action} className="mt-8 space-y-6">
             <input type="hidden" name="token" value={token} />

             {state?.errors?.general && (
               <div className="bg-red-50 text-red-600 p-3 rounded-md text-sm">
                 {state.errors.general.join(', ')}
               </div>
             )}

             <div>
               <label htmlFor="password" className="block text-sm font-medium text-gray-700">
                 New password
               </label>
               <input
                 id="password"
                 name="password"
                 type="password"
                 autoComplete="new-password"
                 required
                 minLength={8}
                 className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
               />
               {state?.errors?.password && (
                 <p className="mt-1 text-sm text-red-600">{state.errors.password.join(', ')}</p>
               )}
               <p className="mt-1 text-xs text-gray-500">Must be at least 8 characters</p>
             </div>

             <button
               type="submit"
               disabled={pending}
               className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"
             >
               {pending ? 'Resetting...' : 'Reset password'}
             </button>
           </form>
         )
       }

       export default function ResetPasswordPage() {
         return (
           <Suspense fallback={<div className="text-center py-8">Loading...</div>}>
             <ResetPasswordForm />
           </Suspense>
         )
       }
       ```

    6. Create LogoutButton component (frontend/app/components/LogoutButton.tsx):
       ```tsx
       'use client'

       import { logout } from '@/app/actions/auth'

       export default function LogoutButton() {
         return (
           <form action={logout}>
             <button
               type="submit"
               className="text-sm text-gray-600 hover:text-gray-900"
             >
               Sign out
             </button>
           </form>
         )
       }
       ```

    7. Update root layout (frontend/app/layout.tsx):
       ```tsx
       import type { Metadata } from 'next'
       import { Inter } from 'next/font/google'
       import './globals.css'

       const inter = Inter({ subsets: ['latin'] })

       export const metadata: Metadata = {
         title: 'Influenza - Influencer Call Tracker',
         description: 'Track and visualize influencer market calls',
       }

       export default function RootLayout({
         children,
       }: {
         children: React.ReactNode
       }) {
         return (
           <html lang="en">
             <body className={inter.className}>{children}</body>
           </html>
         )
       }
       ```

    8. Create dashboard/home page (frontend/app/page.tsx):
       ```tsx
       import { getUser } from '@/app/lib/dal'
       import LogoutButton from '@/app/components/LogoutButton'

       export default async function DashboardPage() {
         const user = await getUser()

         return (
           <div className="min-h-screen bg-gray-50">
             <header className="bg-white shadow">
               <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
                 <h1 className="text-2xl font-bold text-gray-900">Influenza</h1>
                 <div className="flex items-center gap-4">
                   <span className="text-sm text-gray-600">{user?.email_address}</span>
                   <LogoutButton />
                 </div>
               </div>
             </header>
             <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
               <div className="bg-white rounded-lg shadow p-6">
                 <h2 className="text-lg font-medium text-gray-900">Welcome to Influenza</h2>
                 <p className="mt-2 text-gray-600">
                   Your influencer call tracking dashboard. More features coming soon!
                 </p>
                 {user?.admin && (
                   <div className="mt-4 p-4 bg-indigo-50 rounded-md">
                     <p className="text-sm text-indigo-700">
                       You are an administrator. Admin features will appear here.
                     </p>
                   </div>
                 )}
               </div>
             </main>
           </div>
         )
       }
       ```
  </action>
  <verify>
    ```bash
    cd frontend
    ls -la app/\(auth\)/*/page.tsx
    ls -la app/page.tsx
    npm run build
    ```
    All page files exist. Build completes successfully.
  </verify>
  <done>
    - Auth layout with centered card design
    - Login page with email/password form, error handling, pending state
    - Signup page with invite token verification, shows email from invite
    - Forgot password page with email input, success message
    - Reset password page with token from URL, new password input
    - Dashboard page showing user email and logout button
    - Admin indicator on dashboard for admin users
    - LogoutButton component using Server Action
    - All pages use Tailwind for styling
    - All forms show validation errors
    - All forms show loading/pending states
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. Frontend builds without errors: `cd frontend && npm run build`
2. All auth pages render correctly when visited
3. With Rails API running (from Plan 01):
   - Login with admin credentials redirects to dashboard
   - Dashboard shows user email and logout button
   - Logout redirects to login
   - Visiting / without session redirects to /login
   - Visiting /login with session redirects to /
   - Signup with valid invite token creates account
   - Forgot password shows success message
</verification>

<success_criteria>
- Next.js 16 app running on port 3001
- Login page at /login with form
- Signup page at /signup requiring token query param
- Forgot password at /forgot-password
- Reset password at /reset-password requiring token query param
- Dashboard at / showing user info (protected)
- Session stored in httpOnly cookie
- Middleware protects routes correctly
- Server Actions handle all auth flows
- DAL provides cached user data access
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-authentication/01-02-SUMMARY.md`
</output>
